!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.soundo=e():t.soundo=e()}(self,(()=>(()=>{"use strict";var t={m:{},d:(e,r)=>{for(var n in r)t.o(r,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:r[n]})},u:t=>t+".soundo.js"};t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),t.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),t.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{var e;t.g.importScripts&&(e=t.g.location+"");var r=t.g.document;if(!e&&r&&(r.currentScript&&(e=r.currentScript.src),!e)){var n=r.getElementsByTagName("script");if(n.length)for(var a=n.length-1;a>-1&&!e;)e=n[a--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),t.p=e})(),t.b=document.baseURI||self.location.href;var e={};t.r(e),t.d(e,{ADSR_custom:()=>Yt,ADSR_exp:()=>zt,ADSR_line:()=>$t,default:()=>te,instruments:()=>Zt,operators:()=>Xt});var r={};t.r(r),t.d(r,{AM:()=>w,default:()=>x});var n={};t.r(n),t.d(n,{CHRouter2In6Out:()=>A,default:()=>M});var a={};t.r(a),t.d(a,{FM:()=>G,default:()=>R});var i={};t.r(i),t.d(i,{CHPhaser:()=>P,default:()=>U});var o={};t.r(o),t.d(o,{LinearCrossfading:()=>B,default:()=>J});var s={};t.r(s),t.d(s,{MixCrossfading:()=>tt,default:()=>et});var c={};t.r(c),t.d(c,{RM:()=>it,default:()=>ot});var u={};t.r(u),t.d(u,{WS:()=>pt,default:()=>_t});var p={};t.r(p),t.d(p,{FM1c2m:()=>qt,default:()=>bt});var _={};t.r(_),t.d(_,{FM1c2sm:()=>Et,default:()=>jt});var d={};t.r(d),t.d(d,{FM2c1m:()=>Mt,default:()=>St});var m={};t.r(m),t.d(m,{FMAcim:()=>Rt,default:()=>It});var l={};function h(t){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},h(t)}t.r(l),t.d(l,{FMselfc:()=>Wt,default:()=>Dt});var f=function(t,e,r){var n=new DocumentFragment;return Object.keys(t.opts).forEach((function(r){var a=q(t,e,r,"param"),i=q(t,e,r,"enum");a&&n.appendChild(a),i&&n.appendChild(i)})),r&&n.appendChild(r(t,e)),n},g=function(t,e,r,n){var a=t||new DocumentFragment;return Object.keys(e.opts).forEach((function(t){var n=q(e,r,t,"param"),i=q(e,r,t,"enum");n&&a.appendChild(n),i&&a.appendChild(i)})),n&&a.appendChild(n(e,r)),a},v=function(t){return{values:["sine","triangle","square","sawtooth"],onchange:function(e){return t.type=e}}},y=function(t,e){t&&Array.prototype.slice.call(t.childNodes).forEach((function(e){return t.removeChild(e)})),e&&(e.port.postMessage({type:"set_running",value:!1}),e.disconnect())};function q(t,e,r,n){var a={param:b,enum:O},i=t.opts[r+"_"+n];if(!i)return null;var o=document.createElement("div");return o.classList.add("container"),(i=Array.isArray(i)?i:[i]).forEach((function(s,c){var u=a[n](t,e,r,s,1===i.length?void 0:c);o.appendChild(u)})),o}function b(t,e,r,n,a){var i=e.ctx,o=t.opts[r],s=n.value||o;"object"===h(s)&&(s=s.value);var c=document.createElement("div");c.classList.add("container","param",r);var u=document.createElement("div");u.classList.add("label"),u.textContent=r+(void 0!==a?"-"+a:"");var p=document.createElement("input");return p.classList.add("input-val"),p.setAttribute("type","number"),p.setAttribute("min",o.min||"0"),o.max&&p.setAttribute("max",o.max),p.setAttribute("step",o.step||"0.1"),p.value=s,p.addEventListener("change",(function(){var e=t.opts[r+"_param"];e&&(e.cancelScheduledValues(i.currentTime),e.setValueAtTime(p.value,i.currentTime))})),c.appendChild(u),c.appendChild(p),c}function O(t,e,r,n,a){var i=n.value||t.opts[r],o=document.createElement("div");o.classList.add("container","enum",r);var s=document.createElement("div");s.classList.add("label"),s.textContent=r+(void 0!==a?"-"+a:"");var c=null;return"int"===n.values?((c=document.createElement("input")).classList.add("input-val"),c.setAttribute("type","number"),c.setAttribute("min","0"),c.setAttribute("step","0.1"),c.value=i,c.addEventListener("change",(function(){n.onchange(c.value)}))):Array.isArray(n.values)&&(c=document.createElement("select"),n.values.forEach((function(t){var e=document.createElement("option");e.value=t,e.textContent=t,c.appendChild(e)})),c.addEventListener("change",(function(){n.onchange(c.value)}))),c?(o.appendChild(s),o.appendChild(c),o):null}var w=function(t){Object.assign(this,{mod:{},opts:Object.assign({carrier_freq:220,carrier_type:"sine",modulator_freq:10,modulator_type:"sine",carrier_g:.8,modulator_g:2},t||{}),init:E.bind(this),start:j.bind(this),stop:C.bind(this)})};const x=w;function E(t){var e=t.ctx,r=t.master_g,n=e.createGain(),a=e.createOscillator(),i=e.createGain(),o=e.createOscillator(),s=e.createGain();a.frequency.value=this.opts.carrier_freq,this.opts.carrier_freq_param=a.frequency,o.frequency.value=this.opts.modulator_freq,this.opts.modulator_freq_param=o.frequency,a.type=this.opts.carrier_type,this.opts.carrier_type_enum=v(a),o.type=this.opts.modulator_type,this.opts.modulator_type_enum=v(o),i.gain.value=this.opts.carrier_g,this.opts.carrier_g_param=i.gain,s.gain.value=this.opts.modulator_g,this.opts.modulator_g_param=s.gain,o.connect(s).connect(i.gain),a.connect(i).connect(n).connect(r),Object.assign(this.mod,{g:n,carrier:a,c_g:i,modulator:o,m_g:s});var c=this;return t.show_docfrag&&(window.AM=this.mod,c=f(this,t)),c}function j(t){var e=this.mod;[e.carrier,e.modulator].forEach((function(t){return t.start()}))}function C(t){var e=this.mod;[e.carrier,e.modulator].forEach((function(t){return t.stop()}))}function T(t){return t}var A=function(t){Object.assign(this,{mod:{},opts:Object.assign({osc_l_freq:110,osc_l_type:"sine",osc_l_gain_l:.8,osc_l_gain_r:.2,osc_r_freq:70,osc_r_type:"sine",osc_r_gain_l:.2,osc_r_gain_r:.8},t||{}),init:S.bind(this),start:F.bind(this),stop:L.bind(this)})};const M=A;function S(e){var r=this,n=e.ctx,a=e.master_g,i=new T(new URL(t.p+t.u(950),t.b));n.audioWorklet.addModule(i).then((function(){var t=new AudioWorkletNode(n,"channel-router-processor",{numberOfInputs:2,numberOfOutputs:1,outputChannelCount:[6]});t.port.postMessage({type:"set_channels_mapping",value:{0:0,1:1,2:0,3:1,4:0,5:1}}),t.channelCountMode="explicit",t.channelInterpretation="discrete",n.destination.channelCount=6,n.destination.channelCountMode="explicit",n.destination.channelInterpretation="discrete",a.channelCount=6,a.channelCountMode="explicit",a.channelInterpretation="discrete",c.connect(u).connect(o),c.connect(p).connect(s),_.connect(d).connect(o),_.connect(m).connect(s),o.connect(t,0,0).connect(a),s.connect(t,0,1).connect(a),Object.assign(r.mod,{chrNode:t})}));var o=n.createGain(),s=n.createGain(),c=n.createOscillator(),u=n.createGain(),p=n.createGain();c.frequency.value=this.opts.osc_l_freq,this.opts.osc_l_freq_param=c.frequency,c.type=this.opts.osc_l_type,this.opts.osc_l_type_enum=v(c),u.gain.value=this.opts.osc_l_gain_l,this.opts.osc_l_gain_l_param=u.gain,p.gain.value=this.opts.osc_l_gain_r,this.opts.osc_l_gain_r_param=p.gain;var _=n.createOscillator(),d=n.createGain(),m=n.createGain();_.frequency.value=this.opts.osc_r_freq,this.opts.osc_r_freq_param=_.frequency,_.type=this.opts.osc_r_type,this.opts.osc_r_type_enum=v(_),d.gain.value=this.opts.osc_r_gain_l,this.opts.osc_r_gain_l_param=d.gain,m.gain.value=this.opts.osc_r_gain_r,this.opts.osc_r_gain_r_param=m.gain,Object.assign(this.mod,{osc_l:c,osc_l_gl:u,osc_l_gr:p,osc_r:_,osc_r_gl:d,osc_r_gr:m});var l=this;return e.show_docfrag&&(window.CHRouter2In6Out=this.mod,l=f(this,e)),l}function F(t){var e=this.mod;[e.osc_l,e.osc_r].forEach((function(t){return t.start()}))}function L(t){var e=t.ctx,r=t.master_g,n=t.container;e.destination.channelCount=2,e.destination.channelCountMode="max",e.destination.channelInterpretation="speakers",r.channelCount=2,r.channelCountMode="max",r.channelInterpretation="speakers";var a=this.mod,i=a.osc_l,o=a.osc_r,s=a.chrNode;[i,o].forEach((function(t){return t.stop()})),y(n,s)}var G=function(t){Object.assign(this,{mod:{},opts:Object.assign({carrier_freq:220,carrier_type:"sine",modulator_freq:10,modulator_type:"sine",d_gain:40,carrier_g:.8},t||{}),init:I.bind(this),start:V.bind(this),stop:N.bind(this)})};const R=G;function I(t){var e=this,r=t.ctx,n=t.master_g,a=r.createOscillator(),i=r.createGain(),o=r.createOscillator(),s=r.createGain();a.frequency.value=this.opts.carrier_freq,o.frequency.value=this.opts.modulator_freq,this.opts.modulator_freq_param=o.frequency,a.type=this.opts.carrier_type,this.opts.carrier_type_enum=v(a),o.type=this.opts.modulator_type,this.opts.modulator_type_enum=v(o),s.gain.value=this.opts.d_gain,this.opts.d_gain_param=s.gain,i.gain.value=this.opts.carrier_g,this.opts.carrier_g_param=i.gain,o.connect(s).connect(a.frequency),a.connect(i).connect(n),Object.assign(this.mod,{carrier:a,c_g:i,modulator:o,d:s,change_i:function(t,e){return o.frequency.value=e||o.frequency.value,s.gain.value=o.frequency.value*t,{d_gain:s.gain.value}},change_i_exp:function(t,e,n){o.frequency.value=e||o.frequency.value;var a=o.frequency.value*t;return s.gain.cancelScheduledValues(r.currentTime),s.gain.setValueAtTime(s.gain.value,r.currentTime),s.gain.exponentialRampToValueAtTime(a,r.currentTime+n),{d_gain:s.gain.value}},change_pitch:function(t){a.frequency.value=t;var r=t*o.frequency.value/a.frequency.value,n=s.gain.value/o.frequency.value;return{mod_freq:r,ratio_tobe_kept:n,d_gain:e.mod.change_i(n,r).d_gain}},change_pitch_exp:function(t,n){a.frequency.setValueAtTime(a.frequency.value,r.currentTime),a.frequency.exponentialRampToValueAtTime(t,r.currentTime+n);var i=t*o.frequency.value/a.frequency.value,c=s.gain.value/o.frequency.value;return{mod_freq:i,ratio_tobe_kept:c,d_gain:e.mod.change_i_exp(c,i,n).d_gain}}});var c=this;return t.show_docfrag&&(window.FM=this.mod,c=f(this,t,k)),c}function V(t){var e=this.mod;[e.carrier,e.modulator].forEach((function(t){return t.start()}))}function N(t){var e=this.mod;[e.carrier,e.modulator].forEach((function(t){return t.stop()}))}function k(t,e){var r=new DocumentFragment;return["change_i","change_pitch"].forEach((function(e){var n=document.createElement("div");n.classList.add("container");var a=document.createElement("div");a.classList.add("label"),a.textContent=e;var i="change_i"===e?function(){var e=document.createElement("div");return e.classList.add("container","container-opts","change-i"),["ratio","time"].forEach((function(r){var n=document.createElement("div");n.classList.add("opt-container",r);var a=document.createElement("div");a.textContent=r;var i=document.createElement("input");i.classList.add("input-val"),i.value="ratio"===r?t.mod.d.gain.value/t.mod.modulator.frequency.value:0,i.setAttribute("type","number"),i.setAttribute("min","0"),i.setAttribute("step","time"===r?"1":"0.1"),i.addEventListener("change",(function(){var r=W(e),n=parseInt(r.querySelector(".change-i > .time > .input-val").value),a=parseFloat(r.querySelector(".change-i > .ratio > .input-val").value),i=r.querySelector(".d_gain > .input-val"),o=t.mod.modulator.frequency.value,s=t.mod[n?"change_i_exp":"change_i"](a,o,n).d_gain;i.value=s})),n.appendChild(a),n.appendChild(i),e.appendChild(n)})),e}():function(){var e=document.createElement("div");return e.classList.add("container","container-opts","change-pitch"),["carrier_freq","time"].forEach((function(r){var n=document.createElement("div");n.classList.add("opt-container",r);var a=document.createElement("div");a.textContent=r;var i=document.createElement("input");i.classList.add("input-val"),i.value="carrier_freq"===r?t.mod.carrier.frequency.value:0,i.setAttribute("type","number"),i.setAttribute("min","0"),i.setAttribute("step","time"===r?"1":"0.1"),i.addEventListener("change",(function(){var r=W(e),n=parseInt(r.querySelector(".change-pitch > .time > .input-val").value),a=parseFloat(r.querySelector(".change-pitch > .carrier_freq > .input-val").value),i=r.querySelector(".change-i > .ratio > .input-val"),o=r.querySelector(".modulator_freq > .input-val"),s=r.querySelector(".d_gain > .input-val"),c=t.mod[n?"change_pitch_exp":"change_pitch"](a,n),u=c.ratio_tobe_kept,p=c.mod_freq,_=c.d_gain;i.value=u,o.value=p,s.value=_})),n.appendChild(a),n.appendChild(i),e.appendChild(n)})),e}();n.appendChild(a),n.appendChild(i),r.appendChild(n)})),r}function W(t){return t.classList.contains("controls")||t.classList.contains("main-container")?t:W(t.parentElement)}var D=null,P=function(t){Object.assign(this,{mod:{},opts:Object.assign({osc_freq:220,osc_type:"sine",chp_freq:5.7},t||{}),init:H.bind(this),start:$.bind(this),stop:z.bind(this)})};const U=P;function H(e){var r=this,n=e.ctx,a=e.master_g,i=new T(new URL(t.p+t.u(62),t.b));n.audioWorklet.addModule(i).then((function(){var t=new AudioWorkletNode(n,"ch-phaser-processor",{numberOfOutputs:1,outputChannelCount:[2]}),i=!0;r.opts.chp_freq_param&&(i=!1);var s=t.parameters.get("frequency");if(s.value=r.opts.chp_freq,r.opts.chp_freq_param=s,o.connect(t).connect(a),Object.assign(r.mod,{chpNode:t}),e.show_docfrag&&e.container&&i){var c=g(D,{opts:{chp_freq:r.opts.chp_freq,chp_freq_param:r.opts.chp_freq_param}},e);e.container.appendChild(c)}}));var o=n.createOscillator();o.frequency.value=this.opts.osc_freq,this.opts.osc_freq_param=o.frequency,o.type=this.opts.osc_type,this.opts.osc_type_enum=v(o),Object.assign(this.mod,{osc:o});var s=this;return e.show_docfrag&&(window.CHPhaser=this.mod,s=D=f(this,e)),s}function $(t){this.mod.osc.start()}function z(t){var e=this.mod,r=e.osc,n=e.chpNode;r.stop(),y(t.container,n),D=null}var Y=null,B=function(t){Object.assign(this,{mod:{},opts:Object.assign({osc1_freq:220,osc1_type:"sine",osc2_freq:110,osc2_type:"sine",cf_amount:.5},t||{}),init:K.bind(this),start:Q.bind(this),stop:X.bind(this)})};const J=B;function K(e){var r=this,n=e.ctx,a=e.master_g,i=n.createOscillator();i.frequency.value=this.opts.osc1_freq,this.opts.osc1_freq_param=i.frequency,i.type=this.opts.osc1_type,this.opts.osc1_type_enum=v(i);var o=n.createOscillator();o.frequency.value=this.opts.osc2_freq,this.opts.osc2_freq_param=o.frequency,o.type=this.opts.osc2_type,this.opts.osc2_type_enum=v(o);var s=new T(new URL(t.p+t.u(375),t.b));n.audioWorklet.addModule(s).then((function(){var t=new AudioWorkletNode(n,"linear-crossfading-processor",{numberOfInputs:2,numberOfOutputs:2}),s=!0;r.opts.cf_amount_param&&(s=!1);var c=t.parameters.get("amount");if(c.value=r.opts.cf_amount,r.opts.cf_amount_param=c,i.connect(t),o.connect(t,0,1),t.connect(a),Object.assign(r.mod,{cfpNode:t}),e.show_docfrag&&e.container&&s){var u=g(Y,{opts:{cf_amount:r.opts.cf_amount,cf_amount_param:r.opts.cf_amount_param}},e);e.container.appendChild(u)}})),Object.assign(this.mod,{osc_1:i,osc_2:o});var c=this;return e.show_docfrag&&(window.LinearCrossfading=this.mod,c=Y=f(this,e)),c}function Q(t){var e=this.mod;[e.osc_1,e.osc_2].forEach((function(t){return t.start()}))}function X(t){var e=this.mod,r=e.osc_1,n=e.osc_2,a=e.cfpNode;[r,n].forEach((function(t){return t.stop()})),y(t.container,a),Y=null}var Z=null,tt=function(t){Object.assign(this,{mod:{},opts:Object.assign({osc1_freq:2,osc1_type:"sawtooth",osc2_freq:3.5,osc2_type:"square",cf_amount:{value:.2,max:1},cf_mix_length:{value:.01,step:.01}},t||{}),init:rt.bind(this),start:nt.bind(this),stop:at.bind(this)})};const et=tt;function rt(e){var r=this,n=e.ctx,a=e.master_g,i=n.createOscillator();i.frequency.value=this.opts.osc1_freq,this.opts.osc1_freq_param=i.frequency,i.type=this.opts.osc1_type,this.opts.osc1_type_enum=v(i);var o=n.createOscillator();o.frequency.value=this.opts.osc2_freq,this.opts.osc2_freq_param=o.frequency,o.type=this.opts.osc2_type,this.opts.osc2_type_enum=v(o);var s=new T(new URL(t.p+t.u(693),t.b));n.audioWorklet.addModule(s).then((function(){var t=new AudioWorkletNode(n,"mix-crossfading-processor",{numberOfInputs:2,numberOfOutputs:2}),s=!0;r.opts.cf_amount_param&&(s=!1);var c=t.parameters.get("amount");c.value=r.opts.cf_amount.value,r.opts.cf_amount_param=c;var u=t.parameters.get("mix_length");if(u.value=r.opts.cf_mix_length.value,r.opts.cf_mix_length_param=u,i.connect(t),o.connect(t,0,1),t.connect(a),Object.assign(r.mod,{cfpNode:t}),e.show_docfrag&&e.container&&s){var p=g(Z,{opts:{cf_amount:r.opts.cf_amount,cf_amount_param:r.opts.cf_amount_param,cf_mix_length:r.opts.cf_mix_length,cf_mix_length_param:r.opts.cf_mix_length_param}},e);e.container.appendChild(p)}})),Object.assign(this.mod,{osc_1:i,osc_2:o});var c=this;return e.show_docfrag&&(window.MixCrossfading=this.mod,c=Z=f(this,e)),c}function nt(t){var e=this.mod;[e.osc_1,e.osc_2].forEach((function(t){return t.start()}))}function at(t){var e=this.mod,r=e.osc_1,n=e.osc_2,a=e.cfpNode;[r,n].forEach((function(t){return t.stop()})),y(t.container,a),Z=null}var it=function(t){return Object.assign(this,{mod:{},opts:Object.assign({carrier_freq:220,carrier_type:"sine",modulator_freq:10,modulator_type:"sine",carrier_g:.8,modulator_g:2},t||{}),init:st.bind(this),start:ct.bind(this),stop:ut.bind(this)})};const ot=it;function st(t){var e=t.ctx,r=t.master_g,n=e.createOscillator(),a=e.createGain(),i=e.createOscillator(),o=e.createGain();n.frequency.value=this.opts.carrier_freq,this.opts.carrier_freq_param=n.frequency,i.frequency.value=this.opts.modulator_freq,this.opts.modulator_freq_param=i.frequency,n.type=this.opts.carrier_type,this.opts.carrier_type_enum=v(n),i.type=this.opts.modulator_type,this.opts.modulator_type_enum=v(i),a.gain.value=this.opts.carrier_g,this.opts.carrier_g_param=a.gain,o.gain.value=this.opts.modulator_g,this.opts.modulator_g_param=o.gain,i.connect(o).connect(a),n.connect(a).connect(r),Object.assign(this.mod,{carrier:n,c_g:a,modulator:i,m_g:o});var s=this;return t.show_docfrag&&(window.RM=this.mod,s=f(this,t)),s}function ct(t){var e=this.mod;[e.carrier,e.modulator].forEach((function(t){return t.start()}))}function ut(t){var e=this.mod;[e.carrier,e.modulator].forEach((function(t){return t.stop()}))}var pt=function(t){Object.assign(this,{mod:{},opts:Object.assign({carrier_freq:220,carrier_type:"sine",carrier_g:1,shaping_amount:4,shaping_harmonics:[.1,.1,.1,.1,.1],shaping_fn:"distortion"},t||{}),init:dt.bind(this),start:vt.bind(this),stop:yt.bind(this)})};const _t=pt;function dt(t){var e=this,r=t.ctx,n=t.master_g,a=r.createWaveShaper(),i=r.createOscillator(),o=r.createGain();i.frequency.value=this.opts.carrier_freq,this.opts.carrier_freq_param=i.frequency,i.type=this.opts.carrier_type,this.opts.carrier_type_enum=v(i),o.gain.value=this.opts.carrier_g,this.opts.carrier_g_param=o.gain;var s=this.opts.shaping_harmonics.length,c=this.opts.shaping_harmonics,u=this.opts.shaping_amount,p={distortion:{fn:lt,set_args:function(t,r){return t.bind(null,parseFloat(r||e.opts.shaping_amount))}},chebishev:{fn:ht,set_args:function(t,e){return Object.assign(t.bind(null,s,c.map((function(t){return t*parseFloat(e||1)}))),Object.assign({},ft))}}},_=p[this.opts.shaping_fn];a.curve=mt(r,_.set_args(_.fn)),this.opts.shaping_harmonics_enum=c.map((function(t,e){return{values:"int",value:t,onchange:function(t){c[e]=parseFloat(t),a.curve=mt(r,_.set_args(_.fn,u))}}})),this.opts.shaping_amount_enum={values:"int",onchange:function(t){u=parseFloat(t),a.curve=mt(r,_.set_args(_.fn,u))}},this.opts.shaping_fn_enum={values:["distortion","chebishev"],onchange:function(t){_=p[t],a.curve=mt(r,_.set_args(_.fn,u))}},i.connect(o).connect(a).connect(n),Object.assign(this.mod,{carrier:i,c_g:o,ws:a});var d=this;return t.show_docfrag&&(window.WS=this.mod,d=f(this,t)),d}function mt(t,e){var r=t.sampleRate,n=new Float32Array(r);e.init_processing&&e.init_processing(e);for(var a=0;a<r;a++){var i=2*a/r-1;n[a]=e(i),e.step_processing&&e.step_processing(e,n[a])}return e.post_processing?e.post_processing(e,n):n}function lt(t,e){var r="number"==typeof t?t:50;return(3+r)*e*20*(Math.PI/180)/(Math.PI+r*Math.abs(e))}function ht(t,e,r){var n=function(r){for(var n=gt(1,r),a=2;a<t+2;a++)n+=e[a-2]*gt(a,r);return n};return n(r)-n(0)}var ft={f1_max:Number.NEGATIVE_INFINITY,init_processing:function(t){return t.f1_max=Number.NEGATIVE_INFINITY},step_processing:function(t,e){return t.f1_max=Math.max(t.f1_max,e)},post_processing:function(t,e){for(var r=0;r<e.length;r++)e[r]/=t.f1_max;return e}};function gt(t,e){return 0===t?1:1===t?e:2*e*gt(t-1,e)+gt(t-2,e)}function vt(t){this.mod.carrier.start()}function yt(t){this.mod.carrier.stop()}var qt=function(t){Object.assign(this,{mod:{},opts:Object.assign({modulator1_freq:7,modulator1_type:"sine",d1_gain:40,modulator2_freq:22,modulator2_type:"sine",d2_gain:20,mods_g:1,carrier_freq:100,carrier_type:"sine",carrier_g:1},t||{}),init:Ot.bind(this),start:wt.bind(this),stop:xt.bind(this)})};const bt=qt;function Ot(t){var e=t.ctx,r=t.master_g,n=e.createOscillator(),a=e.createGain(),i=e.createOscillator(),o=e.createGain(),s=e.createGain(),c=e.createOscillator(),u=e.createGain();return n.frequency.value=this.opts.modulator1_freq,this.opts.modulator1_freq_param=n.frequency,a.gain.value=this.opts.d1_gain,this.opts.d1_gain_param=a.gain,i.frequency.value=this.opts.modulator2_freq,this.opts.modulator2_freq_param=i.frequency,o.gain.value=this.opts.d2_gain,this.opts.d2_gain_param=o.gain,s.gain.value=this.opts.mods_g,this.opts.mods_g_param=s.gain,c.frequency.value=this.opts.carrier_freq,this.opts.carrier_freq_param=c.frequency,u.gain.value=this.opts.carrier_g,this.opts.carrier_g_param=u.gain,c.type=this.opts.carrier_type,this.opts.carrier_type_enum=v(c),n.type=this.opts.modulator1_type,this.opts.modulator1_type_enum=v(n),i.type=this.opts.modulator2_type,this.opts.modulator2_type_enum=v(i),n.connect(a),i.connect(o),a.connect(s),o.connect(s.gain),s.connect(c.frequency),c.connect(u),u.connect(r),Object.assign(this.mod,{m1:n,d1:a,m2:i,d2:o,mods_g:s,c,g:u}),window.FM1c2m=this.mod,t.show_docfrag?f(this,t):this}function wt(t){var e=this.mod;[e.m1,e.m2,e.c].forEach((function(t){return t.start()}))}function xt(t){var e=this.mod;[e.m1,e.m2,e.c].forEach((function(t){return t.stop()}))}var Et=function(t){Object.assign(this,{mod:{},opts:Object.assign({modulator1_freq:7,modulator1_type:"sine",d1_gain:40,modulator2_freq:22,modulator2_type:"sine",d2_gain:20,mods_g:1,carrier_freq:100,carrier_type:"sine",carrier_g:1},t||{}),init:Ct.bind(this),start:Tt.bind(this),stop:At.bind(this)})};const jt=Et;function Ct(t){var e=t.ctx,r=t.master_g,n=e.createOscillator(),a=e.createGain(),i=e.createOscillator(),o=e.createGain(),s=e.createGain(),c=e.createOscillator(),u=e.createGain();return n.frequency.value=this.opts.modulator1_freq,this.opts.modulator1_freq_param=n.frequency,a.gain.value=this.opts.d1_gain,this.opts.d1_gain_param=a.gain,i.frequency.value=this.opts.modulator2_freq,this.opts.modulator2_freq_param=i.frequency,o.gain.value=this.opts.d2_gain,this.opts.d2_gain_param=o.gain,s.gain.value=this.opts.mods_g,this.opts.mods_g_param=s.gain,c.frequency.value=this.opts.carrier_freq,this.opts.carrier_freq_param=c.frequency,c.type=this.opts.carrier_type,this.opts.carrier_type_enum=v(c),n.type=this.opts.modulator1_type,this.opts.modulator1_type_enum=v(n),i.type=this.opts.modulator2_type,this.opts.modulator2_type_enum=v(i),u.gain.value=this.opts.carrier_g,this.opts.carrier_g_param=u.gain,n.connect(a),i.connect(o),a.connect(i.frequency),o.connect(s),s.connect(c.frequency),c.connect(u),u.connect(r),Object.assign(this.mod,{m1:n,d1:a,m2:i,d2:o,mods_g:s,c,g:u}),window.FM1c2sm=this.mod,t.show_docfrag?f(this,t):this}function Tt(t){var e=this.mod;[e.m1,e.m2,e.c].forEach((function(t){return t.start()}))}function At(t){var e=this.mod;[e.m1,e.m2,e.c].forEach((function(t){return t.stop()}))}var Mt=function(t){Object.assign(this,{mod:{},opts:Object.assign({modulator_freq:7,modulator_type:"sine",d_gain:40,carrier1_freq:200,carrier1_type:"sine",carrier2_freq:40,carrier2_type:"sine",carrier_g:.1},t||{}),init:Ft.bind(this),start:Lt.bind(this),stop:Gt.bind(this)})};const St=Mt;function Ft(t){var e=t.ctx,r=t.master_g,n=e.createOscillator(),a=e.createGain(),i=e.createOscillator(),o=e.createOscillator(),s=e.createGain();return n.frequency.value=this.opts.modulator_freq,this.opts.modulator_freq_param=n.frequency,a.gain.value=this.opts.d_gain,this.opts.d_gain_param=a.gain,i.frequency.value=this.opts.carrier1_freq,this.opts.carrier1_freq_param=i.frequency,o.frequency.value=this.opts.carrier2_freq,this.opts.carrier2_freq_param=o.frequency,s.gain.value=this.opts.carrier_g,this.opts.carrier_g_param=s.gain,n.type=this.opts.modulator_type,this.opts.modulator_type_enum=v(n),i.type=this.opts.carrier1_type,this.opts.carrier1_type_enum=v(i),o.type=this.opts.carrier2_type,this.opts.carrier2_type_enum=v(o),n.connect(a),a.connect(i.frequency),a.connect(o.frequency),i.connect(s),o.connect(s.gain),s.connect(r),Object.assign(this.mod,{m:n,d:a,c1:i,c2:o,g:s}),window.FM2c1m=this.mod,t.show_docfrag?f(this,t):this}function Lt(t){var e=this.mod;[e.m,e.c1,e.c2].forEach((function(t){return t.start()}))}function Gt(t){var e=this.mod;[e.m,e.c1,e.c2].forEach((function(t){return t.stop()}))}var Rt=function(t){Object.assign(this,{mod:{},opts:Object.assign({m1_carrier_freq:80,m1_modulatr_freq:20,m1_d_gain:10,m1_carrier_g:.8,m2_carrier_freq:120,m2_modulator_freq:22,m2_d_gain:10,m2_carrier_g:.8,inst_g:1},t||{}),init:Vt.bind(this),start:Nt.bind(this),stop:kt.bind(this)})};const It=Rt;function Vt(t){var e=t.ctx,r=t.master_g,n=e.createGain(),a=new G({carrier_freq:this.opts.m1_carrier_freq,modulator_freq:this.opts.m1_modulatr_freq,d_gain:this.opts.m1_d_gain,master_g:n,show_docfrag:t.show_docfrag}),i=new G({carrier_freq:this.opts.m2_carrier_freq,modulator_freq:this.opts.m2_modulator_freq,d_gain:this.opts.m2_d_gain,master_g:n.gain,show_docfrag:t.show_docfrag});n.gain.value=this.opts.inst_g;var o=a.init(t),s=i.init(t);return n.connect(r),Object.assign(this.mod,{m1:a,m2:i}),window.FMAcim=this.mod,t.show_docfrag?function(t,e,r,n){var a=new DocumentFragment;return[r,n].forEach((function(t,e){var r=document.createElement("div"),n=e+1;r.classList.add("main-container","opt-container","fm-acim","mod-"+n);var i=document.createElement("div");i.classList.add("label"),i.textContent="FM MOD "+n,r.appendChild(i),r.appendChild(t),a.appendChild(r)})),a}(0,0,o,s):this}function Nt(t){var e=this;Object.keys(this.mod).forEach((function(t){var r=e.mod[t].mod;[r.carrier,r.modulator].forEach((function(t){return t.start()}))}))}function kt(t){var e=this;Object.keys(this.mod).forEach((function(t){var r=e.mod[t].mod;[r.carrier,r.modulator].forEach((function(t){return t.stop()}))}))}var Wt=function(t){Object.assign(this,{mod:{},opts:Object.assign({mod_g:1,carrier_freq:100,carrier_type:"sine",carrier_g:1},t||{}),init:Pt.bind(this),start:Ut.bind(this),stop:Ht.bind(this)})};const Dt=Wt;function Pt(t){var e=t.ctx,r=t.master_g,n=e.createGain(),a=e.createOscillator(),i=e.createGain();return n.gain.value=this.opts.mod_g,this.opts.mod_g_param=n.gain,a.frequency.value=this.opts.carrier_freq,this.opts.carrier_freq_param=a.frequency,a.type=this.opts.carrier_type,this.opts.carrier_type_enum=v(a),i.gain.value=this.opts.carrier_g,this.opts.carrier_g_param=i.gain,a.connect(i),i.connect(n),n.connect(a.frequency),i.connect(r),Object.assign(this.mod,{c:a,g:i,mod_g:n}),window.FM_selfc=this.mod,t.show_docfrag?f(this,t):this}function Ut(t){this.mod.c.start()}function Ht(t){this.mod.c.stop()}function $t(t){var e=t.audioContext,r=t.node,n=t.startVal,a=t.a,i=t.d,o=t.s,s=t.r;r.cancelScheduledValues(e.currentTime),r.setValueAtTime(n,e.currentTime),[a,i,o,s].forEach((function(t,n,a){var i=t.val,o=t.tconst,s=a.reduce((function(t,e,r){return r<=n?t+e.time:t}),0);o?r.setTargetAtTime(i||1e-5,e.currentTime+s,o):r.linearRampToValueAtTime(i||1e-5,e.currentTime+s)}))}function zt(t){var e=t.audioContext,r=t.node,n=t.startVal,a=t.a,i=t.d,o=t.s,s=t.r;r.cancelScheduledValues(e.currentTime),r.setValueAtTime(n,e.currentTime),[a,i,o,s].forEach((function(t,n,a){var i=t.val,o=t.tconst,s=a.reduce((function(t,e,r){return r<=n?t+e.time:t}),0);o?r.setTargetAtTime(i||1e-5,e.currentTime+s,o):r.exponentialRampToValueAtTime(i||1e-5,e.currentTime+s)}))}function Yt(t){var e=t.audioContext,r=t.node,n=t.startVal,a=t.a,i=t.d,o=t.s,s=t.r;r.cancelScheduledValues(e.currentTime),r.setValueAtTime(n,e.currentTime),r.exponentialRampToValueAtTime(a.val,e.currentTime+a.time),r.exponentialRampToValueAtTime(i.val,e.currentTime+a.time+i.time),r.setTargetAtTime(o.val,e.currentTime+a.time+i.time+o.time,Math.exp(-(a.time+i.time+o.time))),r.exponentialRampToValueAtTime(s.val||1e-5,e.currentTime+a.time+i.time+o.time+s.time)}var Bt={};Bt.WS=u,Bt.RM=c,Bt.MixCrossfading=s,Bt.LinearCrossfading=o,Bt.FuzzyPhaser=i,Bt.FM=a,Bt.ChannelRouter2In6Out=n,Bt.AM=r;var Jt=Bt,Kt={};Kt.FMselfc=l,Kt.FMAcim=m,Kt.FM2c1m=d,Kt.FM1c2sm=_,Kt.FM1c2m=p;var Qt=Kt,Xt={},Zt={};Object.keys(Jt).forEach((function(t){Xt[t]=Jt[t].default})),Object.keys(Qt).forEach((function(t){Zt[t]=Qt[t].default}));const te={operators:Xt,instruments:Zt,ADSR_line:$t,ADSR_exp:zt,ADSR_custom:Yt};return e})()));